{"id":"components/quickview/index.jsx","dependencies":[{"name":"/Users/lucascosta/jobs/tray/taitamariki_5.0/package.json","includedInParent":true,"mtime":1578491139495},{"name":"react","loc":{"line":1,"column":33},"parent":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/components/quickview/index.jsx","resolved":"/Users/lucascosta/jobs/tray/taitamariki_5.0/node_modules/react/index.js"},{"name":"prop-types","loc":{"line":2,"column":22},"parent":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/components/quickview/index.jsx","resolved":"/Users/lucascosta/jobs/tray/taitamariki_5.0/node_modules/prop-types/index.js"},{"name":"react-redux","loc":{"line":3,"column":24},"parent":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/components/quickview/index.jsx","resolved":"/Users/lucascosta/jobs/tray/taitamariki_5.0/node_modules/react-redux/es/index.js"},{"name":"axios","loc":{"line":4,"column":18},"parent":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/components/quickview/index.jsx","resolved":"/Users/lucascosta/jobs/tray/taitamariki_5.0/node_modules/axios/index.js"},{"name":"../../actions","loc":{"line":5,"column":77},"parent":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/components/quickview/index.jsx","resolved":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/actions/index.js"},{"name":"../images/index.jsx","loc":{"line":6,"column":19},"parent":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/components/quickview/index.jsx","resolved":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/components/images/index.jsx"},{"name":"../prices/index.jsx","loc":{"line":7,"column":19},"parent":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/components/quickview/index.jsx","resolved":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/components/prices/index.jsx"},{"name":"../variants/index.jsx","loc":{"line":8,"column":21},"parent":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/components/quickview/index.jsx","resolved":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/components/variants/index.jsx"},{"name":"../../config.json","loc":{"line":9,"column":19},"parent":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/components/quickview/index.jsx","resolved":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/config.json"},{"name":"./css/index.styl","loc":{"line":11,"column":7},"parent":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/components/quickview/index.jsx","resolved":"/Users/lucascosta/jobs/tray/taitamariki_5.0/app/components/quickview/css/index.styl"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactRedux = require(\"react-redux\");\n\nvar _axios = _interopRequireDefault(require(\"axios\"));\n\nvar _actions = require(\"../../actions\");\n\nvar _index = _interopRequireDefault(require(\"../images/index.jsx\"));\n\nvar _index2 = _interopRequireDefault(require(\"../prices/index.jsx\"));\n\nvar _index3 = _interopRequireDefault(require(\"../variants/index.jsx\"));\n\nvar _config = _interopRequireDefault(require(\"../../config.json\"));\n\nrequire(\"./css/index.styl\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; if (obj != null) { var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nvar quickview =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(quickview, _Component);\n\n  function quickview(props) {\n    var _this;\n\n    _classCallCheck(this, quickview);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(quickview).call(this, props));\n    _this.state = {\n      id: undefined,\n      visible: false,\n      name: '',\n      sku: '',\n      description: '',\n      hasVariants: false,\n      availabled: true,\n      saleable: false,\n      qtd: 1,\n      store: 0,\n      hash: 0,\n      url: ''\n    };\n    return _this;\n  }\n\n  _createClass(quickview, [{\n    key: \"close\",\n    value: function close(event) {\n      if (event.target.classList.contains('quickview') || event.target.classList.contains('quickview__button--close') || event.target.classList.contains('quickview__button--continue')) {\n        this.setState({\n          id: undefined,\n          visible: false,\n          name: '',\n          sku: '',\n          descriptionSmall: '',\n          hasVariants: false,\n          availabled: true,\n          saleable: false,\n          qtd: 1,\n          store: 0,\n          hash: 0,\n          url: ''\n        });\n        this.props.setAttributes(0, 0, '', [], true, false);\n        document.querySelector('body').classList.remove('quickview--loaded');\n      }\n    }\n  }, {\n    key: \"init\",\n    value: function init(button) {\n      var _this2 = this;\n\n      var id = button.getAttribute('data-id');\n      this.setState({\n        id: id\n      });\n      this.props.resetBuy();\n\n      _axios.default.get('/web_api/products/' + id).then(function (response) {\n        return response.data;\n      }).then(function (data) {\n        var price = parseFloat(data.Product.price);\n        var offer = parseFloat(data.Product.promotional_price);\n        var payment = data.Product.payment_option;\n        var images = data.Product.ProductImage.map(function (image) {\n          return image.https.replace('https:', '');\n        });\n        var availabled = parseInt(data.Product.available) == 1 ? true : false;\n        var saleable = false;\n\n        if (data.Product.payment_option_details.length) {\n          payment = '<span>' + data.Product.payment_option_details[0].plots + 'x</span> de <span>' + new Intl.NumberFormat('pt-br', {\n            style: 'currency',\n            currency: 'BRL'\n          }).format(data.Product.payment_option_details[0].value) + '</span>';\n        }\n\n        _this2.setState({\n          id: id,\n          visible: true,\n          name: data.Product.name,\n          descriptionSmall: data.Product.description_small,\n          sku: data.Product.id,\n          hasVariants: parseInt(data.Product.has_variation) == 1 ? true : false,\n          store: document.querySelector('html').getAttribute('data-store'),\n          hash: document.querySelector('html').getAttribute('data-session'),\n          url: data.Product.url.http.replace('http:', '')\n        });\n\n        _this2.props.setAttributes(price, offer, payment, images, availabled, saleable);\n\n        document.querySelector('body').classList.add('quickview--loaded');\n      });\n    }\n  }, {\n    key: \"updateInputQtd\",\n    value: function updateInputQtd(event) {\n      var qtd = event.target.value;\n      if (qtd < 1) qtd = 1;\n      this.setState({\n        qtd: qtd\n      });\n      this.props.resetBuy();\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      if (this.props.availabled && !this.state.hasVariants) this.props.setSaleable(true);\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this3 = this;\n\n      var buttons = document.querySelectorAll('[data-quickview-button]');\n      Array.from(buttons).forEach(function (button) {\n        return button.addEventListener('click', function (e) {\n          return _this3.init(e.currentTarget);\n        });\n      });\n      if (this.props.availabled && !this.state.hasVariants) this.props.setSaleable(true);\n    }\n  }, {\n    key: \"buy\",\n    value: function buy(event) {\n      var cart = {\n        session_id: this.state.hash,\n        product_id: this.state.id,\n        quantity: this.state.qtd,\n        variant_id: 0\n      };\n\n      if (this.state.hasVariants) {\n        if (this.props.skuSelected && this.state.qtd) {\n          cart.variant_id = this.props.skuSelected.id;\n        }\n      }\n\n      this.props.addCart([cart]);\n    }\n  }, {\n    key: \"more\",\n    value: function more() {\n      var qtd = this.state.qtd;\n      this.setState({\n        qtd: ++qtd\n      });\n    }\n  }, {\n    key: \"less\",\n    value: function less() {\n      var qtd = this.state.qtd;\n      if (qtd - 1 > 0) qtd--;\n      this.setState({\n        qtd: qtd\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var variants;\n      if (this.state.hasVariants) variants = _react.default.createElement(_index3.default, {\n        id: this.state.id,\n        price: this.props.price,\n        offer: this.props.offer,\n        payment: this.props.payment,\n        images: this.props.images,\n        availabled: this.props.availabled,\n        saleable: this.props.saleable,\n        type: _config.default.quickview.variants\n      });\n      if (!this.state.visible) return _react.default.createElement(\"div\", {\n        \"aria-hidden\": !this.state.visible,\n        className: \"quickview\",\n        id: \"quickview\",\n        style: {\n          \"display\": \"none\"\n        }\n      });\n      return _react.default.createElement(\"section\", {\n        onClick: function onClick(event) {\n          _this4.close(event);\n        },\n        \"aria-hidden\": !this.state.visible,\n        className: \"quickview\",\n        id: \"quickview\"\n      }, this.props.isFinish || _react.default.createElement(\"div\", {\n        className: \"quickview__container\"\n      }, _react.default.createElement(\"button\", {\n        onClick: function onClick(event) {\n          _this4.close(event);\n        },\n        className: \"quickview__button quickview__button--close\"\n      }, _react.default.createElement(\"svg\", {\n        xmlns: \"http://www.w3.org/2000/svg\",\n        viewBox: \"298 388 16 16\"\n      }, \" \", _react.default.createElement(\"path\", {\n        d: \"M307.416,395.993l1.414-1.414c0.196-0.196,0.196-0.512,0-0.707l-0.707-0.707 c-0.195-0.195-0.511-0.196-0.707,0l-1.414,1.414l-1.414-1.413c-0.196-0.196-0.512-0.196-0.708-0.001l-0.707,0.707 c-0.195,0.195-0.195,0.512,0.001,0.708l1.414,1.414l-1.411,1.411c-0.195,0.195-0.195,0.512,0,0.707l0.707,0.707 c0.196,0.195,0.512,0.196,0.707,0l1.411-1.41l1.421,1.421c0.196,0.196,0.513,0.196,0.708,0.001l0.707-0.707 c0.195-0.195,0.195-0.513,0-0.708L307.416,395.993z M306,388c-4.418,0-8,3.582-8,8s3.582,8,8,8c4.419,0,8-3.582,8-8 C314,391.582,310.419,388,306,388z M306,402.499c-3.59,0-6.5-2.91-6.5-6.5c0-3.59,2.91-6.5,6.5-6.5s6.5,2.91,6.5,6.5 C312.5,399.589,309.59,402.499,306,402.499z\"\n      }), \" \")), _react.default.createElement(_index.default, {\n        images: this.props.images\n      }), _react.default.createElement(\"div\", {\n        className: \"quickview__main\"\n      }, _react.default.createElement(\"h1\", {\n        className: \"quckview__name\"\n      }, this.state.name), _react.default.createElement(\"h2\", {\n        className: \"quickivew__sku\"\n      }, \"C\\xF3digo: \", this.state.sku), !this.props.availabled || _react.default.createElement(_index2.default, {\n        price: this.props.price,\n        offer: this.props.offer,\n        payment: this.props.payment\n      }), variants, !this.props.availabled || _react.default.createElement(\"div\", {\n        className: \"quickview__actions\"\n      }, _react.default.createElement(\"div\", {\n        className: \"quickview__quantity\"\n      }, _react.default.createElement(\"button\", {\n        onClick: this.less.bind(this),\n        type: \"button\",\n        className: \"qtds__button qtds__button--less\"\n      }, \"-\"), _react.default.createElement(\"input\", {\n        disabled: !this.props.saleable,\n        type: \"number\",\n        className: \"quickview__qtd\",\n        value: this.state.qtd,\n        onChange: function onChange(e) {\n          _this4.updateInputQtd(e);\n        }\n      }), _react.default.createElement(\"button\", {\n        onClick: this.more.bind(this),\n        type: \"button\",\n        className: \"qtds__button qtds__button--more\"\n      }, \"+\")), _react.default.createElement(\"button\", {\n        disabled: !this.props.saleable,\n        className: \"quickview__button--addcart\",\n        onClick: function onClick(e) {\n          _this4.buy(e);\n        }\n      }, \"Comprar\"), _react.default.createElement(\"a\", {\n        href: this.state.url,\n        className: \"quickview__link quickview__link--more\"\n      }, \"Ver mais detalhes\")), !this.props.isError.error || _react.default.createElement(\"div\", {\n        className: \"quickview__error\"\n      }, this.props.isError.msg), this.props.availabled || _react.default.createElement(\"div\", {\n        className: \"quickview__unavailable\"\n      }, \"No momento este produto est\\xE1 indispon\\xEDvel.\"))), !this.props.isFinish || _react.default.createElement(\"div\", {\n        className: \"quickview__container quickview__finish\"\n      }, _react.default.createElement(\"button\", {\n        onClick: function onClick(event) {\n          _this4.close(event);\n        },\n        className: \"quickview__button quickview__button--close\"\n      }, _react.default.createElement(\"svg\", {\n        xmlns: \"http://www.w3.org/2000/svg\",\n        viewBox: \"0 0 100 100\"\n      }, _react.default.createElement(\"title\", null, \"close\"), _react.default.createElement(\"g\", {\n        id: \"Camada_2\",\n        \"data-name\": \"Camada 2\"\n      }, _react.default.createElement(\"g\", {\n        id: \"Layer_1\",\n        \"data-name\": \"Layer 1\"\n      }, _react.default.createElement(\"path\", {\n        d: \"M75.19,50,98.68,26.51a4.51,4.51,0,0,0,0-6.38L79.87,1.32a4.51,4.51,0,0,0-6.38,0L50,24.81,26.51,1.32a4.51,4.51,0,0,0-6.38,0L1.32,20.13a4.51,4.51,0,0,0,0,6.38L24.81,50,1.32,73.49a4.51,4.51,0,0,0,0,6.38L20.13,98.68a4.51,4.51,0,0,0,6.38,0L50,75.19,73.49,98.68a4.51,4.51,0,0,0,6.38,0L98.68,79.87a4.51,4.51,0,0,0,0-6.38Z\"\n      }))))), _react.default.createElement(\"div\", {\n        className: \"quckview__actions\"\n      }, _react.default.createElement(\"button\", {\n        onClick: function onClick(event) {\n          _this4.close(event);\n        },\n        className: \"quickview__button quickview__button--continue\",\n        type: \"button\"\n      }, \"Continuar Comprando\"), _react.default.createElement(\"a\", {\n        className: \"quickview__button quickview__button--finish\",\n        href: '/loja/carrinho.php?loja=' + this.state.store + '&transID=' + this.state.hash + '&hash=' + this.state.hash\n      }, \"Finalizar Compra\"))));\n    }\n  }]);\n\n  return quickview;\n}(_react.Component);\n\nquickview.propTypes = {\n  price: _propTypes.default.number.isRequired,\n  offer: _propTypes.default.number.isRequired,\n  payment: _propTypes.default.string.isRequired,\n  images: _propTypes.default.array.isRequired,\n  availabled: _propTypes.default.bool.isRequired,\n  saleable: _propTypes.default.bool.isRequired,\n  skuSelected: _propTypes.default.object,\n  isBuy: _propTypes.default.bool.isRequired,\n  isFinish: _propTypes.default.bool.isRequired,\n  isError: _propTypes.default.object.isRequired\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    price: state.quickviewPrice,\n    offer: state.quickviewOffer,\n    payment: state.quickviewPayment,\n    images: state.quickviewImages,\n    availabled: state.quickviewAvailabled,\n    saleable: state.quickviewSaleable,\n    skuSelected: state.quickviewSkuSelected,\n    isBuy: state.isBuy,\n    isFinish: state.buyFinish,\n    isError: state.buyError\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    setAttributes: function setAttributes(price, offer, payment, images, availabled, saleable) {\n      return dispatch((0, _actions.quickviewAttributes)(price, offer, payment, images, availabled, saleable));\n    },\n    addCart: function addCart(cart) {\n      return dispatch((0, _actions.addCart)(cart));\n    },\n    resetBuy: function resetBuy() {\n      return dispatch((0, _actions.resetBuy)());\n    },\n    setSaleable: function setSaleable(saleable) {\n      return dispatch((0, _actions.setQuickviewSaleable)(saleable));\n    }\n  };\n};\n\nvar _default = (0, _reactRedux.connect)(mapStateToProps, mapDispatchToProps)(quickview);\n\nexports.default = _default;"},"sourceMaps":null,"error":null,"hash":"3ca656baea7cb682176940c58758b028","cacheData":{"env":{}}}